Министерство науки и высшего образования Российской Федерации

Федеральное государственное автономное образовательное учреждение

высшего образования

САНКТ-ПЕТЕРБУРГСКИЙ ПОЛИТЕХНИЧЕСКИЙ УНИВЕРСИТЕТ ПЕТРА ВЕЛИКОГО

(ФГАОУ ВО СПбПУ)

Институт электроники и телекоммуникаций

Высшая школа электроники и микросистемной техники

ОТЧЕТ

О ЛАБОРАТОРНОЙ РАБОТЕ №1

(семестр 2)

![](media/image1.png){width="0.7763888888888889in" height="0.4375in"}

  Студент группы      27.03.2025      А.В. Усанов
  ---------------- -- --------------- --------------------
                      подпись, дата   инициалы и фамилия

Санкт-Петербург 2025

> **1 Задание**

В соответствии с 10 вариантом задания, необходимо создать программу,
которая позволяет найти строчку в массиве с максимальной суммой
элементов. (N = 6, M = 6). Написать её код на C и на ассемблере. После
чего скомпилировать Си-код используя riscv-компилятор, получить
дамп-файл из скомпилированного исполняемого файла программы и сохранить
дамп-файл в репозитории, а также продемонстрировать работоспособность
ассемблерного кода.

> **2 Реализация**

В листинге 1 представлен код на языке программирования C, реализующий
поставленную задачу. Программа принимает элементы массива заданного
размера, после чего проводит построчное суммирование и определяет номер
строки с максимальной суммой. Результат выводится в терминале.

Листинг 1 – код на С

  ---------------------------------------------------------------------------------
  \#include &lt;stdio.h&gt;

  \#define N 6

  \#define M 6

  void process(int n, int m, int matrix \[M\]\[N\], int \*result, int \*max\_row)

  {

  for (int i = 0; i &lt; m; ++i) {

  result\[i\] = 0;

  for (int j = 0; j &lt; n; ++j) {

  result\[i\] += matrix\[i\]\[j\];

  }

  if (i == 0 || result\[i\] &gt; result\[\*max\_row\]) {

  \*max\_row = i;

  }

  }

  }

  int main(int argc, char\*\* argv)

  {

  int matrix\[M\]\[N\];

  int result\[M\];

  int max\_row=0;

  for (int i = 0; i &lt; M; ++i) {

  for (int j = 0; j &lt; N; ++j) {

  scanf("%d", &matrix\[i\]\[j\]);

  }

  }

  process(N, M, matrix, result, &max\_row);

  printf("%d\\n", max\_row);

  printf("%d\\n", result\[max\_row\]);

  return 0;

  }
  ---------------------------------------------------------------------------------
  ---------------------------------------------------------------------------------

Полученный код был скомпилирован и загружен в репозиторий. Он оказался
работоспособным. Пример выполнения кода в командной строке представлен
на рисунке 1.

![](media/image2.png){width="0.5854735345581802in"
height="4.783582677165354in"}

Рисунок 1 – Результат работы программы на С

Была создана программа на ассемблере, решающая аналогичную задачу. Её
код представлен в листинге 2. Для понимания работ алгоритма к каждой
строке добавлен комментарий

Листинг 2 – код на ассемблере

  -----------------------------------------------------------------------------------------------------
  .data

  N: .word 6 \# Число столбцов

  M: .word 6 \# Число строк

  matrix: .word 1, 1, 1, 1, 1, 1

  .word 2, 2, 2, 2, 2, 2

  .word 3, 3, 3, 3, 3, 3

  .word 4, 4, 4, 4, 4, 4

  .word 5, 5, 5, 5, 5, 5

  .word 6, 6, 6, 6, 6, 6

  result: .word 0 \# Массив для сумм строк

  .word 0

  .word 0

  .word 0

  .word 0

  .word 0

  maxrow: .word 0 \# Индекс строки с максимальной суммой

  .text

  .globl main

  main:

  \# Подготовка параметров для вызова process

  la a2, N \# адрес N (число столбцов)

  la a3, M \# адрес M (число строк)

  la a4, matrix \# адрес начала матрицы

  la a5, result \# адрес массива сумм

  la a6, maxrow \# адрес переменной maxrow

  call process

  \# Подготовка параметров для вывода результатов

  la a2, maxrow \# адрес переменной maxrow

  la a3, result \# адрес массива result

  call print \# Вызов функции print для вывода сумм строк

  call exit \# Вызов функции завершения программы

  \# Функция print: выводит элементы массива result.

  print:

  lw t1, 0(a2) \# номер строки с максимальной суммой

  slli t2, t1, 2 \# t2 = maxrow \* 4 (смещение в массиве result)

  add t2, t2, a3 \# t2 = &result\[maxrow\]

  lw t3, 0(t2) \# t3 = result\[maxrow\] (максимальная сумма строки)

  addi a0, x0, 1 \# Код системного вызова для печати целого числа

  mv a1, t1 \# Передаём maxrow в a1

  ecall \# Выводим maxrow

  addi a0, x0, 11 \# Код системного вызова для печати символа

  addi a1, x0, 32 \# ASCII-код символа пробела (32 - пробел)

  ecall \# Выводим пробел

  addi a0, x0, 1 \# Код системного вызова печати целого числа

  mv a1, t3 \# Передаём result\[maxrow\] в a1

  ecall \# Выводим result\[maxrow\]

  ret \# Возвращаемся из функции print

  \# Функция exit: завершает выполнение программы.

  exit:

  addi a0, x0, 10 \# Готовим системный вызов для выхода (exit)

  ecall \# Вызов системного вызова, завершающего программу

  \# Функция process: вычисляет сумму элементов каждой строки матрицы и сохраняет её в массив result.

  process:

  lw t1, 0(a2) \# t1 = N (число столбцов)

  lw t2, 0(a3) \# t2 = M (число строк)

  addi t4, x0, 0 \# Инициализация счетчика строк (row pointer)

  addi t0, x0, 0 \# current\_max = 0 (максимальная сумма)

  addi s1, x0, 0 \# max\_row\_index = 0 (индекс максимальной строки)

  init:

  addi t5, x0, 0 \# Обнуляем сумму текущей строки

  addi t3, x0, 0 \# Счетчик столбцов

  cycle:

  lw t6, 0(a4) \# Загружаем элемент матрицы

  addi a4, a4, 4 \# Сдвигаем указатель матрицы

  add t5, t5, t6 \# Добавляем к сумме

  addi t3, t3, 1 \# Увеличиваем счетчик столбцов

  blt t3, t1, cycle \# Повторяем цикл, если столбцы не кончились

  sw t5, 0(a5) \# Сохраняем сумму в result

  addi a5, a5, 4 \# Сдвигаем указатель result

  \# Сравнение с текущим максимумом

  ble t5, t0, skip\_update \# Если текущая сумма &lt;= максимума, пропускаем

  mv t0, t5 \# Обновляем максимальную сумму

  mv s1, t4 \# Сохраняем индекс строки с максимумом

  skip\_update:

  addi t4, t4, 1 \# Увеличиваем счетчик строк

  blt t4, t2, init \# Повторяем для всех строк

  sw s1, 0(a6) \# Сохраняем индекс максимальной строки в maxrow

  ret \# Возвращаемся
  -----------------------------------------------------------------------------------------------------
  -----------------------------------------------------------------------------------------------------

Полученный код оказался работоспособным. На рисунке 2 продемонстрирован
пример его выполнения в симуляторе Venus.

![](media/image3.png){width="6.512845581802274in"
height="3.2388068678915136in"}

Рисунок 2 – Результат работы программы, написанной на ассемблере

**\
**

**ЗАКЛЮЧЕНИЕ**

В результате работы были написаны программы на C и на ассемблере,
которые позволяют найти строчку в массиве с максимальной суммой
элементов. (N = 6, M = 6).

Программы были созданы и протестированы. Обе показали свою
работоспособность.
